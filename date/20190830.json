[
	["p",{"class":"title"},"20190830"],
	["p","今回は使いませんでしたが、Dock上のアイコンは簡単にアニメーションさせることができます。"],
	["video",{"src":"./assets/20190830/fig01.mp4","width":"500"}],
	["pre",["code","class Dock {\n\n\tprivate:\n\n\t\tconst int margin = 16;\n\t\tconst int width  = 512;\n\t\tconst int height = 512;\n\t\tbool b = false;\n\t\tNSDockTile *dock = [[NSApplication sharedApplication] dockTile];\n\t\tNSImageView *view = [[NSImageView alloc] init];\n\t\tNSImage *img;\n\t\tNSBitmapImageRep *bmp;\n\t\tdispatch_source_t timer;\n\n\tpublic:\n\n\t\tDock() {\n\t\t\tthis->bmp = [[NSBitmapImageRep alloc] initWithBitmapDataPlanes:NULL pixelsWide:this->width pixelsHigh:this->height bitsPerSample:8 samplesPerPixel:4 hasAlpha:YES isPlanar:NO colorSpaceName:NSDeviceRGBColorSpace bytesPerRow:NULL bitsPerPixel:NULL];\n\t\t\tthis->img = [[NSImage alloc] initWithSize:NSMakeSize(this->width,this->height)];\n\t\t\t[this->img addRepresentation:this->bmp];\n\t\t\t[this->dock setContentView:view];\n\t\t\t[this->view setImage:this->img];\n\n\t\t\tthis->timer = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER,0,0,dispatch_queue_create(%22ENTER_FRAME%22,0));\n\t\t\tdispatch_source_set_timer(this->timer,dispatch_time(0,0),(1.0/15)*1000000000,0);\n\t\t\tdispatch_source_set_event_handler(this->timer,^{\n\t\t\t\tdispatch_async(dispatch_get_main_queue(),^{\n\t\t\t\t\tunsigned int color = (this->b=!this->b)?0xFF000000:0xFFFFFFFF;\n\t\t\t\t\tfor(int i=this->margin; i<height-(this->margin<<1); i++) {\n\t\t\t\t\t\tunsigned int *dst = ((unsigned int *)[bmp bitmapData])+i*([bmp bytesPerRow]>>2);\n\t\t\t\t\t\tfor(int j=this->margin; j<width-(this->margin<<1); j++) {\n\t\t\t\t\t\t\t*dst++ = color;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t[this->dock display];\n\t\t\t\t});\n\t\t\t});\n\t\t\tif(this->timer) dispatch_resume(this->timer);\n\t\t}\n\n\t\t~Dock() {\n\t\t\t[this->view setImage:nil];\n\t\t\t[this->img removeRepresentation:this->bmp];\n\t\t\tif(this->timer) {\n\t\t\t\tdispatch_source_cancel(this->timer);\n\t\t\t\tthis->timer = nullptr;\n\t\t\t}\n\t\t}\n};"]],
	["p","替わりに再生したファイル数をカウントしてバッチを表示するようにしました。",["br"],"明日のライブでは何曲かかるか楽しみですね。"],
	["img",{"src":"./assets/20190830/fig02.png"}],
	["pre",["code","[[[NSApplication sharedApplication] dockTile] setBadgeLabel:[NSString stringWithFormat:@%22%25d%22,cnt++]];"]]
]